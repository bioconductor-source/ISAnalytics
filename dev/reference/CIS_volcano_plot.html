<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Trace volcano plot for computed CIS data. — CIS_volcano_plot • ISAnalytics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Trace volcano plot for computed CIS data. — CIS_volcano_plot"><meta name="description" content="
Traces a volcano plot for IS frequency and CIS results."><meta property="og:description" content="
Traces a volcano plot for IS frequency and CIS results."><meta property="og:image" content="https://calabrialab.github.io/ISAnalytics/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ISAnalytics</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.15.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/ISAnalytics.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/workflow_start.html">Setting up the workflow and first steps</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="https://calabrialab.github.io/ISAnalytics/"><span class="fa fas fa-code-branch"></span> RELEASE</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/calabrialab/ISAnalytics/"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Trace volcano plot for computed CIS data.</h1>
      <small class="dont-index">Source: <a href="https://github.com/calabrialab/ISAnalytics/blob/devel/R/plotting-functions.R" class="external-link"><code>R/plotting-functions.R</code></a></small>
      <div class="d-none name"><code>CIS_volcano_plot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a>
Traces a volcano plot for IS frequency and CIS results.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">CIS_volcano_plot</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  onco_db_file <span class="op">=</span> <span class="st">"proto_oncogenes"</span>,</span>
<span>  tumor_suppressors_db_file <span class="op">=</span> <span class="st">"tumor_suppressors"</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"human"</span>,</span>
<span>  known_onco <span class="op">=</span> <span class="fu"><a href="known_clinical_oncogenes.html">known_clinical_oncogenes</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  suspicious_genes <span class="op">=</span> <span class="fu"><a href="clinical_relevant_suspicious_genes.html">clinical_relevant_suspicious_genes</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  significance_threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  annotation_threshold_ontots <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  highlight_genes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  title_prefix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  return_df <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Either a simple integration matrix or a data frame resulting
from the call to <a href="CIS_grubbs.html">CIS_grubbs</a> with <code>add_standard_padjust = TRUE</code></p></dd>


<dt id="arg-onco-db-file">onco_db_file<a class="anchor" aria-label="anchor" href="#arg-onco-db-file"></a></dt>
<dd><p>Uniprot file for proto-oncogenes (see details).
If different from default, should be supplied as a path to a file.</p></dd>


<dt id="arg-tumor-suppressors-db-file">tumor_suppressors_db_file<a class="anchor" aria-label="anchor" href="#arg-tumor-suppressors-db-file"></a></dt>
<dd><p>Uniprot file for tumor-suppressor genes.
If different from default, should be supplied as a path to a file.</p></dd>


<dt id="arg-species">species<a class="anchor" aria-label="anchor" href="#arg-species"></a></dt>
<dd><p>One between <code>"human"</code>, <code>"mouse"</code> and <code>"all"</code></p></dd>


<dt id="arg-known-onco">known_onco<a class="anchor" aria-label="anchor" href="#arg-known-onco"></a></dt>
<dd><p>Data frame with known oncogenes. See details.</p></dd>


<dt id="arg-suspicious-genes">suspicious_genes<a class="anchor" aria-label="anchor" href="#arg-suspicious-genes"></a></dt>
<dd><p>Data frame with clinical relevant suspicious
genes. See details.</p></dd>


<dt id="arg-significance-threshold">significance_threshold<a class="anchor" aria-label="anchor" href="#arg-significance-threshold"></a></dt>
<dd><p>The significance threshold</p></dd>


<dt id="arg-annotation-threshold-ontots">annotation_threshold_ontots<a class="anchor" aria-label="anchor" href="#arg-annotation-threshold-ontots"></a></dt>
<dd><p>Value above which genes are annotated
with colorful labels</p></dd>


<dt id="arg-highlight-genes">highlight_genes<a class="anchor" aria-label="anchor" href="#arg-highlight-genes"></a></dt>
<dd><p>Either <code>NULL</code> or a character vector of genes to be
highlighted in the plot even if they're not above the threshold</p></dd>


<dt id="arg-title-prefix">title_prefix<a class="anchor" aria-label="anchor" href="#arg-title-prefix"></a></dt>
<dd><p>A string or character vector to be displayed
in the title - usually the
project name and other characterizing info. If a vector is supplied,
it is concatenated in a single string via <code><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste()</a></code></p></dd>


<dt id="arg-return-df">return_df<a class="anchor" aria-label="anchor" href="#arg-return-df"></a></dt>
<dd><p>Return the data frame used to generate the plot?
This can be useful if the user wants to manually modify the plot with
ggplot2. If TRUE the function returns a list containing both the plot
and the data frame.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A plot or a list containing a plot and a data frame</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="input-data-frame">Input data frame<a class="anchor" aria-label="anchor" href="#input-data-frame"></a></h3>


<p>Users can supply as <code>x</code> either a simple integration matrix or a
data frame resulting from the call to <a href="CIS_grubbs.html">CIS_grubbs</a>.
In the first case an internal call to
the function <code><a href="CIS_grubbs.html">CIS_grubbs()</a></code> is performed.</p>
</div>

<div class="section">
<h3 id="oncogene-and-tumor-suppressor-genes-files">Oncogene and tumor suppressor genes files<a class="anchor" aria-label="anchor" href="#oncogene-and-tumor-suppressor-genes-files"></a></h3>


<p>These files are included in the package for user convenience and are
simply UniProt files with gene annotations for human and mouse.
For more details on how this files were generated use the help
<code><a href="proto_oncogenes.html">?tumor_suppressors</a></code>, <code><a href="proto_oncogenes.html">?proto_oncogenes</a></code></p>
</div>

<div class="section">
<h3 id="known-oncogenes">Known oncogenes<a class="anchor" aria-label="anchor" href="#known-oncogenes"></a></h3>


<p>The default values are included in this package and
it can be accessed by doing:</p>
<p>If the user wants to change this parameter the input data frame must
preserve the column structure. The same goes for the <code>suspicious_genes</code>
parameter (DOIReference column is optional):</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="required-tags">Required tags<a class="anchor" aria-label="anchor" href="#required-tags"></a></h2>


<p>The function will explicitly check for the presence of these tags:</p><ul><li><p>gene_symbol</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Plotting functions:
<code><a href="HSC_population_plot.html">HSC_population_plot</a>()</code>,
<code><a href="circos_genomic_density.html">circos_genomic_density</a>()</code>,
<code><a href="fisher_scatterplot.html">fisher_scatterplot</a>()</code>,
<code><a href="integration_alluvial_plot.html">integration_alluvial_plot</a>()</code>,
<code><a href="sharing_heatmap.html">sharing_heatmap</a>()</code>,
<code><a href="sharing_venn.html">sharing_venn</a>()</code>,
<code><a href="top_abund_tableGrob.html">top_abund_tableGrob</a>()</code>,
<code><a href="top_cis_overtime_heatmap.html">top_cis_overtime_heatmap</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"integration_matrices"</span>, package <span class="op">=</span> <span class="st">"ISAnalytics"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cis_plot</span> <span class="op">&lt;-</span> <span class="fu">CIS_volcano_plot</span><span class="op">(</span><span class="va">integration_matrices</span>,</span></span>
<span class="r-in"><span>    title_prefix <span class="op">=</span> <span class="st">"PJ01"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating CIS_grubbs for x...</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Warning: missing genes in refgenes table</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> A total of 5 genes were found in the input data but not in the refgene table. This may be caused by a mismatch in the annotation phase of the matrix. Here is a summary: </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>     GeneName GeneStrand    chr</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>       &lt;char&gt;     &lt;char&gt; &lt;char&gt;</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 1:    CRELD2          -     15</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 2:      HTR4          +      6</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 3:    UBE2D2          +     16</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 4: LINC01133          +     19</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 5:  PLEKHG4B          -     14</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> NOTE: missing genes will be removed from the final output! Review results carefully</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> A total of 25 IS will be removed because of missing genes ( 1.48 % of total IS in input)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading annotated genes -  species selected: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Homo sapiens (Human)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading annotated genes -  done</span>
<span class="r-in"><span><span class="va">cis_plot</span></span></span>
<span class="r-plt img"><img src="CIS_volcano_plot-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Giulia Pais, Andrea Calabria, Giulio Spinozzi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

