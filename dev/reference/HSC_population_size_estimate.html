<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Hematopoietic stem cells population size estimate. — HSC_population_size_estimate • ISAnalytics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Hematopoietic stem cells population size estimate. — HSC_population_size_estimate"><meta name="description" content="
Hematopoietic stem cells population size estimate with capture-recapture
models."><meta property="og:description" content="
Hematopoietic stem cells population size estimate with capture-recapture
models."><meta property="og:image" content="https://calabrialab.github.io/ISAnalytics/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ISAnalytics</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.15.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/ISAnalytics.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/workflow_start.html">Setting up the workflow and first steps</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="https://calabrialab.github.io/ISAnalytics/"><span class="fa fas fa-code-branch"></span> RELEASE</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/calabrialab/ISAnalytics/"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Hematopoietic stem cells population size estimate.</h1>
      <small class="dont-index">Source: <a href="https://github.com/calabrialab/ISAnalytics/blob/devel/R/population-size-estimate.R" class="external-link"><code>R/population-size-estimate.R</code></a></small>
      <div class="d-none name"><code>HSC_population_size_estimate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a>
Hematopoietic stem cells population size estimate with capture-recapture
models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">HSC_population_size_estimate</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">metadata</span>,</span>
<span>  stable_timepoints <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  aggregation_key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SubjectID"</span>, <span class="st">"CellMarker"</span>, <span class="st">"Tissue"</span>, <span class="st">"TimePoint"</span><span class="op">)</span>,</span>
<span>  blood_lineages <span class="op">=</span> <span class="fu"><a href="blood_lineages_default.html">blood_lineages_default</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  timepoint_column <span class="op">=</span> <span class="st">"TimePoint"</span>,</span>
<span>  seqCount_column <span class="op">=</span> <span class="st">"seqCount_sum"</span>,</span>
<span>  fragmentEstimate_column <span class="op">=</span> <span class="st">"fragmentEstimate_sum"</span>,</span>
<span>  seqCount_threshold <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  fragmentEstimate_threshold <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  nIS_threshold <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  cell_type <span class="op">=</span> <span class="st">"MYELOID"</span>,</span>
<span>  tissue_type <span class="op">=</span> <span class="st">"PB"</span>,</span>
<span>  max_workers <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An aggregated integration matrix. See details.</p></dd>


<dt id="arg-metadata">metadata<a class="anchor" aria-label="anchor" href="#arg-metadata"></a></dt>
<dd><p>An aggregated association file. See details.</p></dd>


<dt id="arg-stable-timepoints">stable_timepoints<a class="anchor" aria-label="anchor" href="#arg-stable-timepoints"></a></dt>
<dd><p>A numeric vector or NULL if there are no
stable time points. NOTE: the vector is NOT intended as a sequence min-max,
every stable time point has to be specified individually</p></dd>


<dt id="arg-aggregation-key">aggregation_key<a class="anchor" aria-label="anchor" href="#arg-aggregation-key"></a></dt>
<dd><p>A character vector indicating the key used for
aggregating x and metadata. Note that x and metadata should always be
aggregated with the same key.</p></dd>


<dt id="arg-blood-lineages">blood_lineages<a class="anchor" aria-label="anchor" href="#arg-blood-lineages"></a></dt>
<dd><p>A data frame containing information on the blood
lineages. Users can supply their own, provided the columns <code>CellMarker</code> and
<code>CellType</code> are present.</p></dd>


<dt id="arg-timepoint-column">timepoint_column<a class="anchor" aria-label="anchor" href="#arg-timepoint-column"></a></dt>
<dd><p>What is the name of the time point column to use?
Note that this column must be present in the key.</p></dd>


<dt id="arg-seqcount-column">seqCount_column<a class="anchor" aria-label="anchor" href="#arg-seqcount-column"></a></dt>
<dd><p>What is the name of the column in x containing the
values of sequence count quantification?</p></dd>


<dt id="arg-fragmentestimate-column">fragmentEstimate_column<a class="anchor" aria-label="anchor" href="#arg-fragmentestimate-column"></a></dt>
<dd><p>What is the name of the column in x
containing the values of fragment estimate quantification? If fragment
estimate is not present in the matrix, param should be set to <code>NULL</code>.</p></dd>


<dt id="arg-seqcount-threshold">seqCount_threshold<a class="anchor" aria-label="anchor" href="#arg-seqcount-threshold"></a></dt>
<dd><p>A single numeric value. After re-aggregating <code>x</code>,
rows with a value greater or equal will be kept, the others will be
discarded.</p></dd>


<dt id="arg-fragmentestimate-threshold">fragmentEstimate_threshold<a class="anchor" aria-label="anchor" href="#arg-fragmentestimate-threshold"></a></dt>
<dd><p>A single numeric value. Threshold
value for fragment estimate, see details.</p></dd>


<dt id="arg-nis-threshold">nIS_threshold<a class="anchor" aria-label="anchor" href="#arg-nis-threshold"></a></dt>
<dd><p>A single numeric value. If a group (row) in the
metadata data frame has a count of distinct integration sites strictly
greater than this number it will be kept, otherwise discarded.</p></dd>


<dt id="arg-cell-type">cell_type<a class="anchor" aria-label="anchor" href="#arg-cell-type"></a></dt>
<dd><p>The cell types to include in the models. Note that
the matching is case-insensitive.</p></dd>


<dt id="arg-tissue-type">tissue_type<a class="anchor" aria-label="anchor" href="#arg-tissue-type"></a></dt>
<dd><p>The tissue types to include in the models. Note that
the matching is case-insensitive.</p></dd>


<dt id="arg-max-workers">max_workers<a class="anchor" aria-label="anchor" href="#arg-max-workers"></a></dt>
<dd><p>Maximum parallel workers allowed</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with the results of the estimates</p>
    </div>
    <div class="section level2">
    <h2 id="input-formats">Input formats<a class="anchor" aria-label="anchor" href="#input-formats"></a></h2>
    <p>Both <code>x</code> and <code>metadata</code> should be supplied to the function in aggregated
format (ideally through the use of <code><a href="aggregate_metadata.html">aggregate_metadata</a></code>
and <code><a href="aggregate_values_by_key.html">aggregate_values_by_key</a></code>).
Note that the <code>aggregation_key</code>, aka the vector of column names used for
aggregation, must contain at least the columns associated with the tags
<code>subject</code>, <code>cell_marker</code>, <code>tissue</code> and a time point column
(the user can specify the name of the
column in the argument <code>timepoint_column</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="specifying-more-than-one-group">Specifying more than one group<a class="anchor" aria-label="anchor" href="#specifying-more-than-one-group"></a></h2>
    <p>Groups for the estimates are computed as a pair of cell type and tissue.
If the user wishes to compute estimates for more than one combination
of cell type and tissue, it is possible to specify them as character
vectors to the fields <code>cell_type</code> and <code>tissue_type</code> respectively,
noting that:</p><ul><li><p>Vectors must have the same length or one of the 2 has to be of length 1</p></li>
<li><p>It is a responsibility of the user to check whether the combination
exists in the dataset provided.</p></li>
</ul><p>Example:
Note that estimates are computed individually for each group.</p>
    </div>
    <div class="section level2">
    <h2 id="on-time-points">On time points<a class="anchor" aria-label="anchor" href="#on-time-points"></a></h2>
    <p>If <code>stable_timepoints</code> is a vector with length &gt; 1, the function will look
for the first available stable time point and slice the data from that
time point onward. If <code>NULL</code> is supplied instead, it means there are no
stable time points available. Note that 0 time points are ALWAYS discarded.
Also, to be included in the analysis, a group must have at least 2
distinct non-zero time points.
NOTE: the vector passed has to contain all individual time points, not
just the minimum and maximum</p>
    </div>
    <div class="section level2">
    <h2 id="setting-a-threshold-for-fragment-estimate">Setting a threshold for fragment estimate<a class="anchor" aria-label="anchor" href="#setting-a-threshold-for-fragment-estimate"></a></h2>
    <p>If fragment estimate is present in the input matrix, the filtering logic
changes slightly: rows in the original matrix are kept if the sequence
count value is greater or equal than the <code>seqCount_threshold</code> AND
the fragment estimate value is greater or equal to the
<code>fragmentEstimate_threshold</code> IF PRESENT (non-zero value).
This means that for rows that miss fragment estimate, the filtering logic
will be applied only on sequence count. If the user wishes not to use
the combined filtering with fragment estimate, simply set
<code>fragmentEstimate_threshold = 0</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="required-tags">Required tags<a class="anchor" aria-label="anchor" href="#required-tags"></a></h2>


<p>The function will explicitly check for the presence of these tags:</p><ul><li><p>subject</p></li>
<li><p>tissue</p></li>
<li><p>cell_marker</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Analysis functions:
<code><a href="CIS_grubbs.html">CIS_grubbs</a>()</code>,
<code><a href="compute_abundance.html">compute_abundance</a>()</code>,
<code><a href="cumulative_is.html">cumulative_is</a>()</code>,
<code><a href="gene_frequency_fisher.html">gene_frequency_fisher</a>()</code>,
<code><a href="is_sharing.html">is_sharing</a>()</code>,
<code><a href="iss_source.html">iss_source</a>()</code>,
<code><a href="sample_statistics.html">sample_statistics</a>()</code>,
<code><a href="top_integrations.html">top_integrations</a>()</code>,
<code><a href="top_targeted_genes.html">top_targeted_genes</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"integration_matrices"</span>, package <span class="op">=</span> <span class="st">"ISAnalytics"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"association_file"</span>, package <span class="op">=</span> <span class="st">"ISAnalytics"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">aggreg</span> <span class="op">&lt;-</span> <span class="fu"><a href="aggregate_values_by_key.html">aggregate_values_by_key</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">integration_matrices</span>,</span></span>
<span class="r-in"><span>    association_file <span class="op">=</span> <span class="va">association_file</span>,</span></span>
<span class="r-in"><span>    value_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"seqCount"</span>, <span class="st">"fragmentEstimate"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">aggreg_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="aggregate_metadata.html">aggregate_metadata</a></span><span class="op">(</span>association_file <span class="op">=</span> <span class="va">association_file</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">estimate</span> <span class="op">&lt;-</span> <span class="fu">HSC_population_size_estimate</span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">aggreg</span>,</span></span>
<span class="r-in"><span>    metadata <span class="op">=</span> <span class="va">aggreg_meta</span>,</span></span>
<span class="r-in"><span>    fragmentEstimate_column <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>    stable_timepoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">180</span>, <span class="fl">360</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    cell_type <span class="op">=</span> <span class="st">"Other"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating number of IS for each group...</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Giulia Pais, Andrea Calabria, Giulio Spinozzi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

