<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Alluvial plots for IS distribution in time. — integration_alluvial_plot • ISAnalytics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Alluvial plots for IS distribution in time. — integration_alluvial_plot"><meta name="description" content="
Alluvial plots allow the visualization of integration sites distribution
in different points in time in the same group.
This functionality requires the suggested package
ggalluvial."><meta property="og:description" content="
Alluvial plots allow the visualization of integration sites distribution
in different points in time in the same group.
This functionality requires the suggested package
ggalluvial."><meta property="og:image" content="https://calabrialab.github.io/ISAnalytics/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ISAnalytics</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.15.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/ISAnalytics.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/workflow_start.html">Setting up the workflow and first steps</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="https://calabrialab.github.io/ISAnalytics/"><span class="fa fas fa-code-branch"></span> RELEASE</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/calabrialab/ISAnalytics/"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Alluvial plots for IS distribution in time.</h1>
      <small class="dont-index">Source: <a href="https://github.com/calabrialab/ISAnalytics/blob/devel/R/plotting-functions.R" class="external-link"><code>R/plotting-functions.R</code></a></small>
      <div class="d-none name"><code>integration_alluvial_plot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a>
Alluvial plots allow the visualization of integration sites distribution
in different points in time in the same group.
This functionality requires the suggested package
<a href="https://corybrunson.github.io/ggalluvial/" class="external-link">ggalluvial</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">integration_alluvial_plot</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SubjectID"</span>, <span class="st">"CellMarker"</span>, <span class="st">"Tissue"</span><span class="op">)</span>,</span>
<span>  plot_x <span class="op">=</span> <span class="st">"TimePoint"</span>,</span>
<span>  plot_y <span class="op">=</span> <span class="st">"fragmentEstimate_sum_PercAbundance"</span>,</span>
<span>  alluvia <span class="op">=</span> <span class="fu"><a href="mandatory_IS_vars.html">mandatory_IS_vars</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  alluvia_plot_y_threshold <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  top_abundant_tbl <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  empty_space_color <span class="op">=</span> <span class="st">"grey90"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A data frame. See details.</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>Character vector containing the column names that identify
unique groups.</p></dd>


<dt id="arg-plot-x">plot_x<a class="anchor" aria-label="anchor" href="#arg-plot-x"></a></dt>
<dd><p>Column name to plot on the x axis</p></dd>


<dt id="arg-plot-y">plot_y<a class="anchor" aria-label="anchor" href="#arg-plot-y"></a></dt>
<dd><p>Column name to plot on the y axis</p></dd>


<dt id="arg-alluvia">alluvia<a class="anchor" aria-label="anchor" href="#arg-alluvia"></a></dt>
<dd><p>Character vector of column names that uniquely identify
alluvia</p></dd>


<dt id="arg-alluvia-plot-y-threshold">alluvia_plot_y_threshold<a class="anchor" aria-label="anchor" href="#arg-alluvia-plot-y-threshold"></a></dt>
<dd><p>Numeric value. Everything below this
threshold on y will be plotted in grey and aggregated. See details.</p></dd>


<dt id="arg-top-abundant-tbl">top_abundant_tbl<a class="anchor" aria-label="anchor" href="#arg-top-abundant-tbl"></a></dt>
<dd><p>Logical. Produce the summary top abundant tables
via <a href="top_abund_tableGrob.html">top_abund_tableGrob</a>?</p></dd>


<dt id="arg-empty-space-color">empty_space_color<a class="anchor" aria-label="anchor" href="#arg-empty-space-color"></a></dt>
<dd><p>Color of the empty portion of the bars (IS below
the threshold). Can be either a string of known colors, an hex code or
<code>NA_character</code> to set the space transparent. All color
specs accepted in ggplot2
are suitable here.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments to pass on to <a href="top_abund_tableGrob.html">top_abund_tableGrob</a></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>For each group a list with the associated plot and optionally
the summary tableGrob</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="input-data-frame">Input data frame<a class="anchor" aria-label="anchor" href="#input-data-frame"></a></h3>


<p>The input data frame must contain all the columns specified in the
arguments <code>group</code>, <code>plot_x</code>, <code>plot_y</code> and <code>alluvia</code>. The standard
input for this function is the data frame obtained via the
<a href="compute_abundance.html">compute_abundance</a> function.</p>
</div>

<div class="section">
<h3 id="plotting-threshold-on-y">Plotting threshold on y<a class="anchor" aria-label="anchor" href="#plotting-threshold-on-y"></a></h3>


<p>The plotting threshold on the quantification on the y axis has the
function to highlight only relevant information on the plot and reduce
computation time. The default value is 1, that acts on the default column
plotted on the y axis which contains a percentage value. This translates
in natural language roughly as "highlight with colors only those
integrations (alluvia) that at least in 1 point in time have an
abundance value &gt;= 1 %". The remaining integrations will be plotted
as a unique layer in the column, colored as specified by the argument
<code>empty_space_color</code>.</p>
</div>

<div class="section">
<h3 id="customizing-the-plot">Customizing the plot<a class="anchor" aria-label="anchor" href="#customizing-the-plot"></a></h3>


<p>The returned plots are ggplot2 objects and can therefore further modified
as any other ggplot2 object. For example, if the user decides to change the
fill scale it is sufficient to do</p>
<p>NOTE: if you requested the computation of the top ten abundant tables and
you want the colors to match you should re-compute them</p>
</div>

<div class="section">
<h3 id="a-note-on-strata-ordering">A note on strata ordering<a class="anchor" aria-label="anchor" href="#a-note-on-strata-ordering"></a></h3>


<p>Strata in each column are ordered first by time of appearance and secondly
in decreasing order of abundance (value of y). It means, for example,
that if the plot has 2 or more columns, in the second column, on top,
will appear first appear IS that appeared in the previous columns and then
all other IS, ordered in decreasing order of abundance.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Plotting functions:
<code><a href="CIS_volcano_plot.html">CIS_volcano_plot</a>()</code>,
<code><a href="HSC_population_plot.html">HSC_population_plot</a>()</code>,
<code><a href="circos_genomic_density.html">circos_genomic_density</a>()</code>,
<code><a href="fisher_scatterplot.html">fisher_scatterplot</a>()</code>,
<code><a href="sharing_heatmap.html">sharing_heatmap</a>()</code>,
<code><a href="sharing_venn.html">sharing_venn</a>()</code>,
<code><a href="top_abund_tableGrob.html">top_abund_tableGrob</a>()</code>,
<code><a href="top_cis_overtime_heatmap.html">top_cis_overtime_heatmap</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"integration_matrices"</span>, package <span class="op">=</span> <span class="st">"ISAnalytics"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"association_file"</span>, package <span class="op">=</span> <span class="st">"ISAnalytics"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">aggreg</span> <span class="op">&lt;-</span> <span class="fu"><a href="aggregate_values_by_key.html">aggregate_values_by_key</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">integration_matrices</span>,</span></span>
<span class="r-in"><span>    association_file <span class="op">=</span> <span class="va">association_file</span>,</span></span>
<span class="r-in"><span>    value_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"seqCount"</span>, <span class="st">"fragmentEstimate"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">abund</span> <span class="op">&lt;-</span> <span class="fu"><a href="compute_abundance.html">compute_abundance</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">aggreg</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">alluvial_plots</span> <span class="op">&lt;-</span> <span class="fu">integration_alluvial_plot</span><span class="op">(</span><span class="va">abund</span>,</span></span>
<span class="r-in"><span>    alluvia_plot_y_threshold <span class="op">=</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ex_plot</span> <span class="op">&lt;-</span> <span class="va">alluvial_plots</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="st">"IS distribution over time"</span>,</span></span>
<span class="r-in"><span>        subtitle <span class="op">=</span> <span class="st">"Patient 1, MNC BM"</span>,</span></span>
<span class="r-in"><span>        y <span class="op">=</span> <span class="st">"Abundance (%)"</span>,</span></span>
<span class="r-in"><span>        x <span class="op">=</span> <span class="st">"Time point (days after GT)"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ex_plot</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="integration_alluvial_plot-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Giulia Pais, Andrea Calabria, Giulio Spinozzi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

